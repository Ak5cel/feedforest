{% extends "layout.html" %}

{% block content %}
	<div class="col-12 d-flex align-items-center justify-content-between">
		<h3 class="mb-4 col-">My Feeds</h3>
		<small class="text-muted">Last updated: {{ last_updated_on.strftime('%B %e, %Y, %I:%M %p %Z') }} UTC</small>
	</div>
	<div class="col">
		{% if current_user.selected_feeds[0] %}
			<div class="card-columns">
				{% for feed in current_user.selected_feeds %}
					<div class="card mb-4">
						<div class="card-body">
							<h4 class="card-title mb-4">
								<a class="text-dark" href="{{ feed.rss_link }}" title="{{ feed.rss_link }}">{{ feed.feed_name }}</a>
							</h4>
							{% for article in feed.articles %}
								{% if article in latest_articles %}
									{% if article in current_user.bookmarked_articles %}
										<div class="article d-flex justify-content-between" data-status="bookmarked" data-article-id="{{ article.id }}">
											<p class="card-text pr-4 pb-1">
												<a href="{{ article.link }}">{{ article.title }}</a>
												{% if article.published_on %}
												<br>
												<small class="text-muted">
													{{ article.published_on.strftime('%B %e, %Y, %I:%M %p %Z') }} UTC
												</small>
												{% endif %}
											</p>
											<a href="#" class="toggle-bookmark">
												<i class="far fa-bookmark"></i>
											</a>
										</div>	
									{% else %}
										<div class="article d-flex justify-content-between" data-status="not-bookmarked" data-article-id="{{ article.id }}">
											<p class="card-text pr-4 pb-1">
												<a href="{{ article.link }}">{{ article.title }}</a>
												{% if article.published_on %}
												<br>
												<small class="text-muted">
													{{ article.published_on.strftime('%B %e, %Y, %I:%M %p %Z') }} UTC
												</small>
												{% endif %}
											</p>
											<a href="#" class="toggle-bookmark">
												<i class="far fa-bookmark"></i>
											</a>
										</div>
									{% endif %}
								{% endif %}			
							{% endfor %}
						</div>
					</div>
				{% endfor %}
			</div>
		{% else %}
			<div class="content-section">
				<div class="d-flex flex-column align-items-center justify-content-center" style="height: 150px">
					<small class="text-muted mb-2">No feeds selected</small>
					<small>
						Click 
						<a href="{{ url_for('user.edit_feeds') }}">Add Feeds</a>
						to start adding feeds!
					</small>
				</div>	
			</div>
		{% endif %}
	</div>
	
{% endblock content %}
{% block scripts %}
	<script src="{{ url_for('static', filename='bookmark-article.js') }}"></script>
{% endblock scripts %}